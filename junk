Feature: Section outputs are validated against section schemas
This covers per-section schemas, validation after guardrails, structured validation errors, success criteria, and telemetry recording.

Scenario: Each section has a schema to validate required fields and types
Given section_id "company_overview" is registered with an output schema
When I request the schema binding for "company_overview"
Then the system can resolve the schema used to validate that sectionâ€™s output

Scenario: Schema validation runs after guardrails and before marking success
Given a section run produces an output draft
And guardrails complete with status "PASS" or "REDACTED"
When the system processes the section output
Then schema validation runs after guardrails
And the section is not marked successful until schema validation passes

Scenario: Schema validation failure returns a structured error
Given section_id "company_overview" has an output schema
And the produced output is missing a required field
When schema validation is performed
Then the system returns a "SCHEMA_VALIDATION_FAILED" error
And the error includes section_id
And the error includes failing field path(s) and validation message(s)

Scenario: Section run is marked successful only if schema validation passes
Given section_id "company_overview" has an output schema
When I run section_id "company_overview"
Then the section outcome is "SUCCESS" only if schema validation passes
And if schema validation fails, the section outcome is "FAILED"

Scenario: Telemetry records schema_valid for every section run (no silent pass)
Given a section is executed
When the run completes (success or failure)
Then telemetry records schema_valid as true or false for that section run
And schema_valid is present for every section run
