Section = a deliverable, not a prompt
Company Overview / Risks / Financials are “sections” of the CAR.

Section is decomposed into Components
Each component is a self-contained unit like:

Business Model

Operating Performance Snapshot

Liquidity Snapshot
Components are reusable across sections.

Component declares two contracts

Evidence contract: retrieval_profile (what source bucket it needs)

Output contract: steps + schema + gates (what it must produce and what rules it must obey)

Outer layer fetches evidence
Using retrieval_profile, the outer search layer returns chunks (the only allowed sources).

Prompt framework builds the prompt bundle
It hydrates:

templates (kpi_extract / extract / compose / verify)

blocks (system, citations, not_disclosed, style)

component instructions

the chunks (+ KPI keys/values depending on step)
Output = PromptBundle (exact messages to send)

Outer layer calls the LLM
Outer service takes PromptBundle + runtime hints (models.yaml) and makes the API call.

Gates validate outputs
Validate JSON/schema, citations required, etc.
If it fails and the component includes verify, run verify step to repair.

Component output is stored
You keep:

extracted facts JSON

narrative text

citations/provenance
This becomes debuggable + regression-testable.

Section narrative is stitched
The section output is simply the ordered concatenation (or wrapper-formatting) of component narratives.

Versioning + regression safety
Switching company_overview/v1 → v2 changes config, not code.
Gates + claim-level eval prevent silent quality regressions.
